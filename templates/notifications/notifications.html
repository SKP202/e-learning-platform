<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Notifications</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        .notification-list-container { max-width: 800px; margin: auto; }
        .notification-item {
            border-left: 5px solid #444;
            padding: 12px 18px;
            margin-bottom: 12px;
            background-color: #22222a;
            border-radius: 5px;
            color: #eee;
            transition: background-color 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }

        .notification-item.unread {
            border-left-color: #39ff14;
            background-color: #2f2f3a;
            font-weight: bold;
        }
        .notification-item p { margin-bottom: 0.5rem; line-height: 1.6; }
        .notification-item a { color: #00fff7; text-decoration: underline; font-weight: normal; }
        .notification-item a:hover { color: #39ff14; }
        .notification-time { font-size: 0.7rem; color: #888; margin-top: 8px; display:block; text-align: right; font-weight: normal;}
    </style>
</head>
<body>
    <button id="menuBtn_notif_page" class="btn arcade-btn" type="button" data-bs-toggle="offcanvas" data-bs-target="#navSlider_notif_page" aria-controls="navSlider_notif_page"
        style="position:fixed; top:2rem; left:2rem; z-index:1051; font-family:'Press Start 2P',cursive,monospace;">
        &#9776; Menu
    </button>
    <div class="offcanvas offcanvas-start" tabindex="-1" id="navSlider_notif_page" aria-labelledby="navSliderLabel_notif_page" style="background:#111; color:#fff;">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="navSliderLabel_notif_page" style="font-family:'Press Start 2P',cursive,monospace;">Navigation</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="nav flex-column" style="gap:1rem;">
            <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('profile.Profile') }}" style="color:#fff;">Profile</a></li>
            <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('courses.courses') }}" style="color:#fff;">Courses</a></li>
            {% if session['role'] == 'teacher' %}
                <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('submissions.teacher_submissions') }}" style="color:#fff;">Submissions</a></li>
                <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('report.report_issue') }}" style="color:#fff;">Report Issue</a></li>
            {% endif %}
             <li class="nav-item">
                <a class="nav-link arcade-btn active" href="{{ url_for('notifications.view_notifications') }}" style="color:#fff;">
                    Notifications
                    {% if unread_notification_count > 0 %}
                        <span class="badge bg-danger rounded-pill ms-1">{{ unread_notification_count }}</span>
                    {% endif %}
                </a>
            </li>
            {% if session['role'] == 'admin' %}
                <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('admin.admin_dashboard') }}" style="color:#fff;">Admin Dashboard</a></li>
            {% endif %}
            <li class="nav-item">
                <a class="nav-link arcade-btn" href="{{ url_for('leaderboard.leaderboard') }}" style="color:#fff;">Leaderboard</a>
            </li>
            <li class="nav-item"><a class="nav-link arcade-btn" href="{{ url_for('auth.logout') }}" style="color:#fff;">Logout</a></li>
        </ul>
      </div>
    </div>

    <script>
        const navSlider_np = document.getElementById('navSlider_notif_page');
        const menuBtn_np = document.getElementById('menuBtn_notif_page');
        if (navSlider_np && menuBtn_np) {
            navSlider_np.addEventListener('show.bs.offcanvas', function () { menuBtn_np.style.display = 'none'; });
            navSlider_np.addEventListener('hidden.bs.offcanvas', function () { menuBtn_np.style.display = 'block'; });
        }
    </script>

    <div class="center-container">
        <h1 class="mb-5" style="color:#39ff14; text-shadow:0 0 10px #39ff14,0 0 20px #39ff14,0 0 40px #00fff7; font-family:'Press Start 2P',cursive,monospace;">Your Notifications</h1>
        <div class="container notification-list-container" style="background:#111a; padding:2rem; border-radius:1rem; box-shadow:0 0 20px #00fff7;">
            {% if notifications %}
                {% for notification in notifications %}
                    <div class="notification-item {% if not notification.is_read %}unread{% endif %}" style="font-family:'Press Start 2P',cursive,monospace; font-size:0.75rem;">
                        <div class="notification-content">
                            <p>{{ notification.message }}</p>
                            {% if notification.link_url %}
                                <a href="{{ notification.link_url }}">View Details</a>
                            {% endif %}
                            <div class="notification-time">{{ notification.created_at.strftime('%Y-%m-%d %I:%M %p') }}</div>
                        </div>
                        <div class="notification-action">
                            <form method="POST" action="{{ url_for('notifications.delete_notification', notification_id=notification.id) }}" title="Delete this notification">
                                <button type="submit" class="btn-close" aria-label="Delete"></button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color:#fff; font-family:'Press Start 2P',cursive,monospace; text-align:center;">You have no notifications.</p>
            {% endif %}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
 <script>
        window.addEventListener('load', function() {
            const allFlashMessages = document.querySelectorAll('.alert.fade.show');
            allFlashMessages.forEach(function(messageElement) {
                setTimeout(function() {
                    const bsAlert = new bootstrap.Alert(messageElement);
                    bsAlert.close();
                }, 5000);
            });
        });
 </script>
</body>
</html>